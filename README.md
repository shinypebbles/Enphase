# Enphase
```
CREATE TABLE  "ENPHASE" 
   (	"SAMPLE_DATE" DATE DEFAULT sysdate, 
	"DATA" CLOB, 
	 CONSTRAINT "ENPHASE_JSON_CHK" CHECK (data IS JSON) ENABLE
   )
/

CREATE TABLE  "ENPHASEPRODUCTION" 
   (	"SAMPLE_DATE" DATE DEFAULT sysdate, 
	"DATA" CLOB, 
	 CONSTRAINT "ENPHASEPROD_JSON_CHK" CHECK (data IS JSON) ENABLE
   )
/

CREATE TABLE  "ENPHASEPRODUCTION2" 
   (	"SAMPLE_DATE" DATE DEFAULT sysdate, 
	"DATA" CLOB, 
	 CONSTRAINT "ENPHASEPROD2_JSON_CHK" CHECK (data IS JSON) ENABLE
   )
/
```
```
import requests
import oracledb
import my_secrets

print(oracledb.__version__)

connection = oracledb.connect(user=my_secrets.user, password=my_secrets.password, dsn=my_secrets.dsn)

sql1 = ('insert into enphase(data) '
        'values(:json_data)')
sql2 = ('insert into enphaseproduction(data) '
        'values(:json_data)')
sql3 = ('insert into enphaseproduction2(data) '
        'values(:json_data)')

url1 = "https://envoy/api/v1/production/inverters"
url2 = "https://envoy/production.json?details=1"
url3 = "https://envoy/api/v1/production"

headers = {
"accept" : "application/json",
"Authorization": "Bearer "+my_secrets.token
}

# https://stackoverflow.com/questions/16511337/correct-way-to-try-except-using-python-requests-module
# https://stackoverflow.com/questions/56576236/how-to-pass-jwt-token-in-python-for-request-get
# https://www.oracletutorial.com/python-oracle/inserting-data/
try:
    r = requests.get(url1, headers=headers, verify=False, timeout=5)
    r.raise_for_status()
    json_data = r.text 

    print(json_data);
    with connection.cursor() as cursor:
        # execute the insert statement
        cursor.execute(sql1, [json_data])
        # commit work
        connection.commit()
except requests.exceptions.HTTPError as err:
    raise SystemExit(err)

try:
    r = requests.get(url2, headers=headers, verify=False, timeout=5)
    r.raise_for_status()
    json_data = r.text 

    print(json_data);
    with connection.cursor() as cursor:
        # execute the insert statement
        cursor.execute(sql2, [json_data])
        # commit work
        connection.commit()
except requests.exceptions.HTTPError as err:
    raise SystemExit(err)

try:
    r = requests.get(url3, headers=headers, verify=False, timeout=5)
    r.raise_for_status()
    json_data = r.text 

    print(json_data);
    with connection.cursor() as cursor:
        # execute the insert statement
        cursor.execute(sql3, [json_data])
        # commit work
        connection.commit()
except requests.exceptions.HTTPError as err:
    raise SystemExit(err)
```
```
select to_char(P.sample_date, 'DD-MM-YYYY HH24:MI') as "sample date"
, P.data.production.readingTime as "readingTime"
, to_char(epoch2cet_cest(P.data.production.readingTime), 'DD-MM-YYYY HH24:MI:SS') as "readingTime"
, P.data.production.wNow as "wNow"
, P2.data.wattsNow as "wattsNow"
from ENPHASEPRODUCTION P, ENPHASEPRODUCTION2 P2
where P.sample_date > to_date('8-11-2023 0', 'DD-MM-YYYY HH24')
and to_char(P.sample_date, 'DD-MM-YYYY HH24:MI')=to_char(P2.sample_date, 'DD-MM-YYYY HH24:MI')
order by P.sample_date
```
```
08-11-2023 09:55	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 09:56	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 09:57	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 09:58	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:00	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:01	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:02	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:03	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:04	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:05	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:06	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:07	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:08	1699433733	08-11-2023 09:55:33	110	109
08-11-2023 10:09	1699434575	08-11-2023 10:09:35	164	164
08-11-2023 10:10	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:11	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:12	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:13	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:14	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:15	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:16	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:17	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:18	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:19	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:20	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:21	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:22	1699434635	08-11-2023 10:10:35	188	188
08-11-2023 10:24	1699435477	08-11-2023 10:24:37	190	190
08-11-2023 10:27	1699435537	08-11-2023 10:25:37	204	190
08-11-2023 10:28	1699435537	08-11-2023 10:25:37	204	190
08-11-2023 10:31	1699435537	08-11-2023 10:25:37	204	190
08-11-2023 10:33	1699435537	08-11-2023 10:25:37	204	190
08-11-2023 10:38	1699435537	08-11-2023 10:25:37	204	205
08-11-2023 10:40	1699436439	08-11-2023 10:40:39	181	194
08-11-2023 10:41	1699436439	08-11-2023 10:40:39	181	194
08-11-2023 10:43	1699436439	08-11-2023 10:40:39	181	194
08-11-2023 10:44	1699436439	08-11-2023 10:40:39	181	194
08-11-2023 10:49	1699436439	08-11-2023 10:40:39	181	194
08-11-2023 10:51	1699436439	08-11-2023 10:40:39	181	194
08-11-2023 10:52	1699436439	08-11-2023 10:40:39	181	194
08-11-2023 10:53	1699436439	08-11-2023 10:40:39	181	194
08-11-2023 10:54	1699437281	08-11-2023 10:54:41	160	161
08-11-2023 10:58	1699437341	08-11-2023 10:55:41	146	161
08-11-2023 11:01	1699437341	08-11-2023 10:55:41	146	161
08-11-2023 11:02	1699437341	08-11-2023 10:55:41	146	161
08-11-2023 11:04	1699437341	08-11-2023 10:55:41	146	161
08-11-2023 11:06	1699437341	08-11-2023 10:55:41	146	161
08-11-2023 11:07	1699437341	08-11-2023 10:55:41	146	161
08-11-2023 11:08	1699437341	08-11-2023 10:55:41	146	161
08-11-2023 11:12	1699438244	08-11-2023 11:10:44	253	199
08-11-2023 11:13	1699438244	08-11-2023 11:10:44	253	199
08-11-2023 11:17	1699438244	08-11-2023 11:10:44	253	199
08-11-2023 11:19	1699438244	08-11-2023 11:10:44	253	199
08-11-2023 11:21	1699438244	08-11-2023 11:10:44	253	199
08-11-2023 11:22	1699438244	08-11-2023 11:10:44	253	254
08-11-2023 11:23	1699438244	08-11-2023 11:10:44	253	254
08-11-2023 11:24	1699438244	08-11-2023 11:10:44	253	254
08-11-2023 11:26	1699439176	08-11-2023 11:26:16	231	231
08-11-2023 11:29	1699439176	08-11-2023 11:26:16	231	231
08-11-2023 11:34	1699439176	08-11-2023 11:26:16	231	231
08-11-2023 11:36	1699439176	08-11-2023 11:26:16	231	231
08-11-2023 11:37	1699439176	08-11-2023 11:26:16	231	231
08-11-2023 11:38	1699439176	08-11-2023 11:26:16	231	231
08-11-2023 11:41	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:43	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:45	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:46	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:47	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:48	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:49	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:51	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:52	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:53	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:54	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:55	1699440108	08-11-2023 11:41:48	180	180
08-11-2023 11:56	1699440979	08-11-2023 11:56:19	149	180
08-11-2023 11:57	1699441040	08-11-2023 11:57:20	113	149
08-11-2023 11:58	1699441040	08-11-2023 11:57:20	113	149
08-11-2023 11:59	1699441040	08-11-2023 11:57:20	113	149
08-11-2023 12:00	1699441040	08-11-2023 11:57:20	113	149
08-11-2023 12:01	1699441040	08-11-2023 11:57:20	113	149
08-11-2023 12:03	1699441040	08-11-2023 11:57:20	113	149
08-11-2023 12:06	1699441040	08-11-2023 11:57:20	113	149
08-11-2023 12:07	1699441040	08-11-2023 11:57:20	113	113
08-11-2023 12:09	1699441040	08-11-2023 11:57:20	113	113
08-11-2023 12:11	1699441881	08-11-2023 12:11:21	116	113
08-11-2023 12:12	1699441971	08-11-2023 12:12:51	120	116
08-11-2023 12:13	1699441971	08-11-2023 12:12:51	120	116
08-11-2023 12:17	1699441971	08-11-2023 12:12:51	120	116
08-11-2023 12:19	1699441971	08-11-2023 12:12:51	120	116
08-11-2023 12:21	1699441971	08-11-2023 12:12:51	120	116
08-11-2023 12:23	1699441971	08-11-2023 12:12:51	120	116
08-11-2023 12:24	1699441971	08-11-2023 12:12:51	120	116
08-11-2023 12:27	1699442873	08-11-2023 12:27:53	158	158
08-11-2023 12:28	1699442873	08-11-2023 12:27:53	158	158
08-11-2023 12:34	1699442873	08-11-2023 12:27:53	158	158
08-11-2023 12:38	1699442873	08-11-2023 12:27:53	158	158
08-11-2023 12:40	1699442873	08-11-2023 12:27:53	158	158
08-11-2023 12:48	1699443775	08-11-2023 12:42:55	262	212
08-11-2023 12:49	1699443775	08-11-2023 12:42:55	262	212
08-11-2023 12:56	1699444617	08-11-2023 12:56:57	216	261
08-11-2023 12:57	1699444677	08-11-2023 12:57:57	165	166
08-11-2023 12:58	1699444677	08-11-2023 12:57:57	165	166
08-11-2023 12:59	1699444677	08-11-2023 12:57:57	165	166
08-11-2023 13:01	1699444677	08-11-2023 12:57:57	165	166
08-11-2023 13:06	1699444677	08-11-2023 12:57:57	165	166
08-11-2023 13:08	1699444677	08-11-2023 12:57:57	165	166
08-11-2023 13:09	1699444677	08-11-2023 12:57:57	165	166
08-11-2023 13:10	1699444677	08-11-2023 12:57:57	165	166
08-11-2023 13:11	1699444677	08-11-2023 12:57:57	165	166
08-11-2023 13:13	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:14	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:15	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:16	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:17	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:18	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:19	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:20	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:21	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:22	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:23	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:24	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:26	1699445579	08-11-2023 13:12:59	162	161
08-11-2023 13:27	1699446482	08-11-2023 13:28:02	200	181
08-11-2023 13:28	1699446482	08-11-2023 13:28:02	200	181
08-11-2023 13:29	1699446482	08-11-2023 13:28:02	200	181
08-11-2023 13:30	1699446482	08-11-2023 13:28:02	200	181
08-11-2023 13:31	1699446482	08-11-2023 13:28:02	200	181
08-11-2023 13:33	1699446482	08-11-2023 13:28:02	200	181
08-11-2023 13:35	1699446482	08-11-2023 13:28:02	200	181
08-11-2023 13:36	1699446482	08-11-2023 13:28:02	200	181
08-11-2023 13:37	1699446482	08-11-2023 13:28:02	200	200
08-11-2023 13:38	1699446482	08-11-2023 13:28:02	200	200
08-11-2023 13:39	1699446482	08-11-2023 13:28:02	200	200
08-11-2023 13:43	1699447414	08-11-2023 13:43:34	112	158
08-11-2023 13:47	1699447414	08-11-2023 13:43:34	112	158
08-11-2023 13:49	1699447414	08-11-2023 13:43:34	112	158
08-11-2023 13:50	1699447414	08-11-2023 13:43:34	112	158
08-11-2023 13:52	1699447414	08-11-2023 13:43:34	112	158
08-11-2023 13:53	1699447414	08-11-2023 13:43:34	112	158
08-11-2023 13:55	1699447414	08-11-2023 13:43:34	112	158
08-11-2023 13:56	1699447414	08-11-2023 13:43:34	112	158
08-11-2023 13:57	1699447414	08-11-2023 13:43:34	112	158
08-11-2023 14:09	1699448345	08-11-2023 13:59:05	76	94
08-11-2023 14:10	1699448345	08-11-2023 13:59:05	76	94
08-11-2023 14:11	1699448345	08-11-2023 13:59:05	76	94
08-11-2023 14:12	1699448345	08-11-2023 13:59:05	76	94
08-11-2023 14:18	1699449276	08-11-2023 14:14:36	69	73
08-11-2023 14:19	1699449276	08-11-2023 14:14:36	69	73
08-11-2023 14:21	1699449276	08-11-2023 14:14:36	69	73
08-11-2023 14:22	1699449276	08-11-2023 14:14:36	69	69
08-11-2023 14:23	1699449276	08-11-2023 14:14:36	69	69
08-11-2023 14:24	1699449276	08-11-2023 14:14:36	69	69
08-11-2023 14:27	1699449276	08-11-2023 14:14:36	69	69
08-11-2023 14:29	1699450178	08-11-2023 14:29:38	55	62
08-11-2023 14:30	1699450178	08-11-2023 14:29:38	55	62
08-11-2023 14:31	1699450178	08-11-2023 14:29:38	55	62
08-11-2023 14:38	1699450178	08-11-2023 14:29:38	55	62
08-11-2023 14:41	1699450178	08-11-2023 14:29:38	55	62
08-11-2023 14:43	1699451050	08-11-2023 14:44:10	45	45
08-11-2023 14:44	1699451080	08-11-2023 14:44:40	36	45
08-11-2023 14:49	1699451080	08-11-2023 14:44:40	36	45
08-11-2023 14:51	1699451080	08-11-2023 14:44:40	36	45
08-11-2023 14:54	1699451080	08-11-2023 14:44:40	36	45
08-11-2023 14:55	1699451080	08-11-2023 14:44:40	36	45
08-11-2023 14:56	1699451080	08-11-2023 14:44:40	36	45
08-11-2023 14:57	1699451080	08-11-2023 14:44:40	36	45
08-11-2023 14:58	1699451952	08-11-2023 14:59:12	41	41
08-11-2023 15:02	1699451982	08-11-2023 14:59:42	47	47
08-11-2023 15:03	1699451982	08-11-2023 14:59:42	47	47
08-11-2023 15:04	1699451982	08-11-2023 14:59:42	47	47
08-11-2023 15:06	1699451982	08-11-2023 14:59:42	47	47
08-11-2023 15:07	1699451982	08-11-2023 14:59:42	47	47
08-11-2023 15:11	1699451982	08-11-2023 14:59:42	47	47
08-11-2023 15:13	1699451982	08-11-2023 14:59:42	47	47
08-11-2023 15:18	1699452884	08-11-2023 15:14:44	47	47
08-11-2023 15:22	1699452884	08-11-2023 15:14:44	47	47
08-11-2023 15:23	1699452884	08-11-2023 15:14:44	47	47
08-11-2023 15:24	1699452884	08-11-2023 15:14:44	47	47
08-11-2023 15:27	1699452884	08-11-2023 15:14:44	47	47
08-11-2023 15:28	1699452884	08-11-2023 15:14:44	47	47
08-11-2023 15:30	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:31	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:32	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:33	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:34	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:35	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:36	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:37	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:38	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:39	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:40	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:41	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:42	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:43	1699453786	08-11-2023 15:29:46	30	39
08-11-2023 15:46	1699454688	08-11-2023 15:44:48	17	24
08-11-2023 15:47	1699454688	08-11-2023 15:44:48	17	24
08-11-2023 15:48	1699454688	08-11-2023 15:44:48	17	24
08-11-2023 15:49	1699454688	08-11-2023 15:44:48	17	24
08-11-2023 15:53	1699454688	08-11-2023 15:44:48	17	18
08-11-2023 15:56	1699454688	08-11-2023 15:44:48	17	18
08-11-2023 15:57	1699454688	08-11-2023 15:44:48	17	18
08-11-2023 15:59	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:00	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:01	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:02	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:03	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:06	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:07	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:09	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:11	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:12	1699455591	08-11-2023 15:59:51	16	17
08-11-2023 16:16	1699456522	08-11-2023 16:15:22	13	14
08-11-2023 16:19	1699456522	08-11-2023 16:15:22	13	14
08-11-2023 16:20	1699456522	08-11-2023 16:15:22	13	14
08-11-2023 16:21	1699456522	08-11-2023 16:15:22	13	14
08-11-2023 16:22	1699456522	08-11-2023 16:15:22	13	14
08-11-2023 16:23	1699456522	08-11-2023 16:15:22	13	14
08-11-2023 16:24	1699456522	08-11-2023 16:15:22	13	14
08-11-2023 16:25	1699456522	08-11-2023 16:15:22	13	14
08-11-2023 16:36	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 16:37	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 16:38	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 16:44	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 16:46	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 16:49	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 16:53	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 16:54	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 16:56	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 16:59	1699457454	08-11-2023 16:30:54	1	0
08-11-2023 17:02	0		01-01-1970 01:00:00	0	0
08-11-2023 17:03	0		01-01-1970 01:00:00	0	0
08-11-2023 17:04	0		01-01-1970 01:00:00	0	0
08-11-2023 17:06	0		01-01-1970 01:00:00	0	0
08-11-2023 17:07	0		01-01-1970 01:00:00	0	0
08-11-2023 17:08	0		01-01-1970 01:00:00	0	0
08-11-2023 17:09	0		01-01-1970 01:00:00	0	0
08-11-2023 17:10	0		01-01-1970 01:00:00	0	0
```
